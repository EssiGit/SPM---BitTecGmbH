<!DOCTYPE html>
<html lang="de" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8">
    <title>KaufDort Homepage</title>
      <link rel="stylesheet" href="css/style2.css">
<script src="https://d3js.org/d3.v7.min.js"></script>

  </head>
  <body>
    <nav class="navbar">
      <img src="images/LogoKaufDort.gif" alt="Logo">
      <div>

      	<form name="main" method="post" action="main" enctype="multipart/form-data">
    		<input type="file" name="file-input" id="file-input" onchange="document.forms['main'].submit()" style="display:none" accept=".csv"/>
		</form>
		<button onclick="document.getElementById('file-input').click()">Datei Hochladen</button>

        <div class="dropdown">
          <button>Analysen</button>
          <div class="dropdown-content">
            <button type="submit"  th:value="${button1}">File1</button>
            <button type="submit"  th:value="${button2}">File2</button>
            <button type="submit"  th:value="${button3}">File3</button>
            <button type="submit"  th:value="${button4}">File4</button>
            <button type="submit"  th:value="${button5}">File5</button>
            
          </div>
        </div>
      </div>
    </nav>
    
    
    <div class="chart-container">
    <th:block th:each="cluster : ${clusters}">
      <div class="chart" data-name="analyse1" th:id="${cluster.titel}"></div>
      
      <script th:inline="javascript">
      
      var margin = {top: 30, right: 30, bottom: 120, left: 100},
	    width = 1800 - margin.left - margin.right,
	    height = 800 - margin.top - margin.bottom;
		
      var message = /*[[${cluster.titel}]]*/ "";
      console.log(message)
      
      
		var svg = d3.select(/*[[${cluster.titel}]]*/)
			.append("svg")
			.attr("width", width + margin.left + margin.right)
  		.attr("height", height + margin.top + margin.bottom)
  		.style("background", "#dedede")
			.append("g")
  		.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
		
		
		//beispiel Umsatzstärkster Tag
		//JSON einlesen in zeile Z43(CSV geht auch  d3.csv(""))
		
		
		d3.json("./usr_data/exampleData.json").then(function (json) {
		    return [json].map(function (d) {
		        return {
		            "Montag": d.Montag,
		            "Dienstag": d.Dienstag,
		            "Mittwoch": d.Mittwoch,
		            "Donnerstag": d.Donnerstag,
		            "Freitag": d.Freitag,
		            "Samstag": d.Samstag,
		            "Sonntag": d.Sonntag
		        };
		    });
		}).then(function getData(rawData) {
			
		 	var Values = /*[[${cluster.Values}]]*/ ""; //as array[][] example: [[fertigware, Getränke .....],[1000,2000,110000]]
			
		
			//X-Achse
			var x = d3.scaleBand()
	    		.range([ 0, width ])
	    		.domain(Values[0])
	   	 		.padding(0.2);
		
			//X Achse zum svg hinzufuegen
			svg.append("g")
	    		.attr("transform", "translate(0," + height + ")")
	    		.call(d3.axisBottom(x))
	    		.selectAll("text")
	      			.attr("transform", "translate(-10,0)rotate(-45)")
	      			.style("text-anchor", "end")
					.style("font-size","25px");
		
			//Y Achse erstellen
			var y = d3.scaleLinear()
	    		.domain([0, 50000])
	    		.range([ height, 0])
			//Y Achse hinzufuegen
	  		svg.append("g")
	    		.call(d3.axisLeft(y))
				.style("font-size","25px");
			//Balken Hinzufuegen
	 		 svg.selectAll("bar")
	    		.data(Values)
	   			.enter()
	   			.append("rect")
	     		.attr("x", function(d, i) { return x(d[0][i]) })
	      		.attr("y", function(d, i) { return y(d[1][i]) }) 
	      		.attr("width", x.bandwidth())
	     		.attr("height", function(d, i) { return height - y(d[1][i]) })
	      		.attr("fill", "#69b3a2")
	
		
		});
      
      </script>
      
      
    </div>
    </th:block>
  </body>
</html>